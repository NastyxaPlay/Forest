import bridge from '@vkontakte/vk-bridge';
import { createKey } from '../utils/utils';
export class BridgeService {
    // eslint-disable-next-line @typescript-eslint/no-empty-function
    constructor() {
        this.swipeBackConsumers = [];
    }
    static enableNativeSwipeBack() {
        void bridge.send('VKWebAppSetSwipeSettings', { history: true });
        void bridge.send('VKWebAppEnableSwipeBack');
        const instance = BridgeService.instance;
        const consumerId = createKey();
        instance.swipeBackConsumers = [...instance.swipeBackConsumers, consumerId];
        return consumerId;
    }
    static disableNativeSwipeBack(consumerId) {
        const instance = BridgeService.instance;
        /**
         * Тот, кто попросил отключить нативный свайпбек, выходит из списка.
         */
        instance.swipeBackConsumers = instance.swipeBackConsumers.filter((id) => id !== consumerId);
        /**
         * Нативный свайпбек будет отключен только если больше не осталось тех, кому он нужен.
         */
        if (instance.swipeBackConsumers.length === 0) {
            void bridge.send('VKWebAppSetSwipeSettings', { history: false });
            void bridge.send('VKWebAppDisableSwipeBack');
        }
    }
    static get instance() {
        if (!BridgeService._instance) {
            BridgeService._instance = new BridgeService();
        }
        return BridgeService._instance;
    }
}
//# sourceMappingURL=BridgeService.js.map